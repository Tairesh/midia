use roguemetry::Vec2;
use serde::{Deserialize, Serialize};
use tetra::{
    graphics::{DrawParams, Rectangle, Texture},
    Context,
};

#[derive(Serialize, Deserialize, Debug, Copy, Clone, Eq, PartialEq, Hash, Default)]
#[serde(rename_all = "snake_case")]
pub enum Sprite {
    #[default]
    Empty,
    Highlight,
    #[serde(rename = "mt")]
    MoreThan,
    #[serde(rename = "lt")]
    LessThan,
    Minus,
    Plus,
    Cursor,
    Fill,
    Dirt1,
    Dirt2,
    Dirt3,
    Dirt4,
    Dirt5,
    Dirt6,
    Dirt7,
    Dirt8,
    Dirt9,
    Dirt10,
    Grass1,
    Grass2,
    Grass3,
    Grass4,
    Grass5,
    Grass6,
    Grass7,
    Grass8,
    Grass9,
    Grass10,
    Grass11,
    Grass12,
    Grass13,
    Grass14,
    Grass15,
    Grass16,
    Grass17,
    Grass18,
    Grass19,
    Grass20,
    Chest,
    ChestOpen,
    BoulderHuge,
    Boulder,
    BoulderSmall,
    Pit,
    TreeDead,
    PineDead,
    HickoryDead,
    WillowDead,
    BirchDead,
    Tree,
    Pine,
    Hickory,
    Willow,
    Birch,
    Gazan,
    Nyarnik,
    Totik,
    Lagnam,
    GiantBug,
    Cloak,
    Hat,
    Rags,
    Backpack,
    ArmGuard,
    GloveRight,
    GloveLeft,
    KnifeWood,
    KnifeStone,
    KnifeMetal,
    KnifeDemonic,
    AxeWood,
    AxeStone,
    AxeMetal,
    AxeDemonic,
    Buckler,
    KnifeBone,
    SapWood,
    SapStone,
    SapMetal,
    SapDemonic,
    SwordWood,
    SwordStone,
    SwordMetal,
    SwordDemonic,
    SwordObsidian,
    KnifeObsidian,
    ClubWood,
    ClubStone,
    ClubMetal,
    ClubDemonic,
    MaceWood,
    MaceStone,
    MaceMetal,
    MaceDemonic,
    KnuckleObsidian,
    KnuckleBone,
    KnuckleWood,
    KnuckleStone,
    KnuckleMetal,
    KnuckleDemonic,
    HammerWood,
    HammerStone,
    HammerMetal,
    HammerDemonic,
    SpearWood,
    SpearStone,
    SpearMetal,
    SpearDemonic,
    PikeWood,
    PikeStone,
    PikeMetal,
    PikeDemonic,
    BowWood,
    BowDemonic,
    CrossbowWood,
    CrossbowMetal,
    CrossbowDemonic,
    Sling,
    Pipe,
    Pistol,
    Rifle,
    Slingshot,
    ArrowWood,
    ArrowStone,
    ArrowMetal,
    ArrowDemonic,
    ArrowObsidian,
    ArrowExplosive,
    ArrowBone,
    BoomgranateFruit,
    Rock,
    SharpRock,
    Pebble,
    MetalChunk,
    SharpMetalChunk,
    MetalShot,
    DemonicChunk,
    SharpDemonicChunk,
    DemonicShot,
    ObsidianChunk,
    Corpse,
    Book,
    WoodenSplinter,
    FleshChunk,
    Bone,
    Lazuli,
    ShovelWood,
    ShovelStone,
    ShovelMetal,
    ShovelDemonic,
}

#[allow(clippy::too_many_lines)]
const fn region(sprite: Sprite) -> Rectangle {
    match sprite {
        Sprite::Empty => Rectangle::new(0.0, 0.0, 10.0, 10.0),
        Sprite::Highlight => Rectangle::new(10.0, 0.0, 10.0, 10.0),
        Sprite::MoreThan => Rectangle::new(20.0, 0.0, 10.0, 10.0),
        Sprite::LessThan => Rectangle::new(30.0, 0.0, 10.0, 10.0),
        Sprite::Minus => Rectangle::new(40.0, 0.0, 10.0, 10.0),
        Sprite::Plus => Rectangle::new(50.0, 0.0, 10.0, 10.0),
        Sprite::Cursor => Rectangle::new(60.0, 0.0, 10.0, 10.0),
        Sprite::Fill => Rectangle::new(70.0, 0.0, 10.0, 10.0),
        Sprite::Dirt1 => Rectangle::new(0.0, 10.0, 10.0, 10.0),
        Sprite::Dirt2 => Rectangle::new(10.0, 10.0, 10.0, 10.0),
        Sprite::Dirt3 => Rectangle::new(20.0, 10.0, 10.0, 10.0),
        Sprite::Dirt4 => Rectangle::new(30.0, 10.0, 10.0, 10.0),
        Sprite::Dirt5 => Rectangle::new(40.0, 10.0, 10.0, 10.0),
        Sprite::Dirt6 => Rectangle::new(50.0, 10.0, 10.0, 10.0),
        Sprite::Dirt7 => Rectangle::new(60.0, 10.0, 10.0, 10.0),
        Sprite::Dirt8 => Rectangle::new(70.0, 10.0, 10.0, 10.0),
        Sprite::Dirt9 => Rectangle::new(80.0, 10.0, 10.0, 10.0),
        Sprite::Dirt10 => Rectangle::new(90.0, 10.0, 10.0, 10.0),
        Sprite::Grass1 => Rectangle::new(0.0, 20.0, 10.0, 10.0),
        Sprite::Grass2 => Rectangle::new(10.0, 20.0, 10.0, 10.0),
        Sprite::Grass3 => Rectangle::new(20.0, 20.0, 10.0, 10.0),
        Sprite::Grass4 => Rectangle::new(30.0, 20.0, 10.0, 10.0),
        Sprite::Grass5 => Rectangle::new(40.0, 20.0, 10.0, 10.0),
        Sprite::Grass6 => Rectangle::new(50.0, 20.0, 10.0, 10.0),
        Sprite::Grass7 => Rectangle::new(60.0, 20.0, 10.0, 10.0),
        Sprite::Grass8 => Rectangle::new(70.0, 20.0, 10.0, 10.0),
        Sprite::Grass9 => Rectangle::new(80.0, 20.0, 10.0, 10.0),
        Sprite::Grass10 => Rectangle::new(90.0, 20.0, 10.0, 10.0),
        Sprite::Grass11 => Rectangle::new(0.0, 30.0, 10.0, 10.0),
        Sprite::Grass12 => Rectangle::new(10.0, 30.0, 10.0, 10.0),
        Sprite::Grass13 => Rectangle::new(20.0, 30.0, 10.0, 10.0),
        Sprite::Grass14 => Rectangle::new(30.0, 30.0, 10.0, 10.0),
        Sprite::Grass15 => Rectangle::new(40.0, 30.0, 10.0, 10.0),
        Sprite::Grass16 => Rectangle::new(50.0, 30.0, 10.0, 10.0),
        Sprite::Grass17 => Rectangle::new(60.0, 30.0, 10.0, 10.0),
        Sprite::Grass18 => Rectangle::new(70.0, 30.0, 10.0, 10.0),
        Sprite::Grass19 => Rectangle::new(80.0, 30.0, 10.0, 10.0),
        Sprite::Grass20 => Rectangle::new(90.0, 30.0, 10.0, 10.0),
        Sprite::Chest => Rectangle::new(0.0, 40.0, 10.0, 10.0),
        Sprite::ChestOpen => Rectangle::new(10.0, 40.0, 10.0, 10.0),
        Sprite::BoulderHuge => Rectangle::new(20.0, 40.0, 10.0, 10.0),
        Sprite::Boulder => Rectangle::new(30.0, 40.0, 10.0, 10.0),
        Sprite::BoulderSmall => Rectangle::new(40.0, 40.0, 10.0, 10.0),
        Sprite::Pit => Rectangle::new(50.0, 40.0, 10.0, 10.0),
        Sprite::TreeDead => Rectangle::new(0.0, 50.0, 20.0, 20.0),
        Sprite::PineDead => Rectangle::new(20.0, 50.0, 20.0, 20.0),
        Sprite::HickoryDead => Rectangle::new(40.0, 50.0, 20.0, 20.0),
        Sprite::WillowDead => Rectangle::new(60.0, 50.0, 20.0, 20.0),
        Sprite::BirchDead => Rectangle::new(80.0, 50.0, 20.0, 20.0),
        Sprite::Tree => Rectangle::new(0.0, 70.0, 20.0, 20.0),
        Sprite::Pine => Rectangle::new(20.0, 70.0, 20.0, 20.0),
        Sprite::Hickory => Rectangle::new(40.0, 70.0, 20.0, 20.0),
        Sprite::Willow => Rectangle::new(60.0, 70.0, 20.0, 20.0),
        Sprite::Birch => Rectangle::new(80.0, 70.0, 20.0, 20.0),
        Sprite::Gazan => Rectangle::new(0.0, 90.0, 10.0, 10.0),
        Sprite::Nyarnik => Rectangle::new(10.0, 90.0, 10.0, 10.0),
        Sprite::Totik => Rectangle::new(20.0, 90.0, 10.0, 10.0),
        Sprite::Lagnam => Rectangle::new(30.0, 90.0, 10.0, 10.0),
        Sprite::GiantBug => Rectangle::new(40.0, 90.0, 10.0, 10.0),
        Sprite::Cloak => Rectangle::new(0.0, 100.0, 10.0, 10.0),
        Sprite::Hat => Rectangle::new(10.0, 100.0, 10.0, 10.0),
        Sprite::Rags => Rectangle::new(20.0, 100.0, 10.0, 10.0),
        Sprite::Backpack => Rectangle::new(30.0, 100.0, 10.0, 10.0),
        Sprite::ArmGuard => Rectangle::new(40.0, 100.0, 10.0, 10.0),
        Sprite::GloveRight => Rectangle::new(50.0, 100.0, 10.0, 10.0),
        Sprite::GloveLeft => Rectangle::new(60.0, 100.0, 10.0, 10.0),
        Sprite::KnifeWood => Rectangle::new(0.0, 120.0, 10.0, 10.0),
        Sprite::KnifeStone => Rectangle::new(10.0, 120.0, 10.0, 10.0),
        Sprite::KnifeMetal => Rectangle::new(20.0, 120.0, 10.0, 10.0),
        Sprite::KnifeDemonic => Rectangle::new(30.0, 120.0, 10.0, 10.0),
        Sprite::AxeWood => Rectangle::new(40.0, 120.0, 10.0, 10.0),
        Sprite::AxeStone => Rectangle::new(50.0, 120.0, 10.0, 10.0),
        Sprite::AxeMetal => Rectangle::new(60.0, 120.0, 10.0, 10.0),
        Sprite::AxeDemonic => Rectangle::new(70.0, 120.0, 10.0, 10.0),
        Sprite::Buckler => Rectangle::new(80.0, 120.0, 10.0, 10.0),
        Sprite::KnifeBone => Rectangle::new(90.0, 120.0, 10.0, 10.0),
        Sprite::SapWood => Rectangle::new(0.0, 130.0, 10.0, 10.0),
        Sprite::SapStone => Rectangle::new(10.0, 130.0, 10.0, 10.0),
        Sprite::SapMetal => Rectangle::new(20.0, 130.0, 10.0, 10.0),
        Sprite::SapDemonic => Rectangle::new(30.0, 130.0, 10.0, 10.0),
        Sprite::SwordWood => Rectangle::new(40.0, 130.0, 10.0, 10.0),
        Sprite::SwordStone => Rectangle::new(50.0, 130.0, 10.0, 10.0),
        Sprite::SwordMetal => Rectangle::new(60.0, 130.0, 10.0, 10.0),
        Sprite::SwordDemonic => Rectangle::new(70.0, 130.0, 10.0, 10.0),
        Sprite::SwordObsidian => Rectangle::new(80.0, 130.0, 10.0, 10.0),
        Sprite::KnifeObsidian => Rectangle::new(90.0, 130.0, 10.0, 10.0),
        Sprite::ClubWood => Rectangle::new(0.0, 140.0, 10.0, 10.0),
        Sprite::ClubStone => Rectangle::new(10.0, 140.0, 10.0, 10.0),
        Sprite::ClubMetal => Rectangle::new(20.0, 140.0, 10.0, 10.0),
        Sprite::ClubDemonic => Rectangle::new(30.0, 140.0, 10.0, 10.0),
        Sprite::MaceWood => Rectangle::new(40.0, 140.0, 10.0, 10.0),
        Sprite::MaceStone => Rectangle::new(50.0, 140.0, 10.0, 10.0),
        Sprite::MaceMetal => Rectangle::new(60.0, 140.0, 10.0, 10.0),
        Sprite::MaceDemonic => Rectangle::new(70.0, 140.0, 10.0, 10.0),
        Sprite::KnuckleObsidian => Rectangle::new(80.0, 140.0, 10.0, 10.0),
        Sprite::KnuckleBone => Rectangle::new(90.0, 140.0, 10.0, 10.0),
        Sprite::KnuckleWood => Rectangle::new(0.0, 150.0, 10.0, 10.0),
        Sprite::KnuckleStone => Rectangle::new(10.0, 150.0, 10.0, 10.0),
        Sprite::KnuckleMetal => Rectangle::new(20.0, 150.0, 10.0, 10.0),
        Sprite::KnuckleDemonic => Rectangle::new(30.0, 150.0, 10.0, 10.0),
        Sprite::HammerWood => Rectangle::new(40.0, 150.0, 10.0, 10.0),
        Sprite::HammerStone => Rectangle::new(50.0, 150.0, 10.0, 10.0),
        Sprite::HammerMetal => Rectangle::new(60.0, 150.0, 10.0, 10.0),
        Sprite::HammerDemonic => Rectangle::new(70.0, 150.0, 10.0, 10.0),
        Sprite::SpearWood => Rectangle::new(0.0, 160.0, 10.0, 10.0),
        Sprite::SpearStone => Rectangle::new(10.0, 160.0, 10.0, 10.0),
        Sprite::SpearMetal => Rectangle::new(20.0, 160.0, 10.0, 10.0),
        Sprite::SpearDemonic => Rectangle::new(30.0, 160.0, 10.0, 10.0),
        Sprite::PikeWood => Rectangle::new(40.0, 160.0, 10.0, 10.0),
        Sprite::PikeStone => Rectangle::new(50.0, 160.0, 10.0, 10.0),
        Sprite::PikeMetal => Rectangle::new(60.0, 160.0, 10.0, 10.0),
        Sprite::PikeDemonic => Rectangle::new(70.0, 160.0, 10.0, 10.0),
        Sprite::BowWood => Rectangle::new(0.0, 170.0, 10.0, 10.0),
        Sprite::BowDemonic => Rectangle::new(10.0, 170.0, 10.0, 10.0),
        Sprite::CrossbowWood => Rectangle::new(20.0, 170.0, 10.0, 10.0),
        Sprite::CrossbowMetal => Rectangle::new(30.0, 170.0, 10.0, 10.0),
        Sprite::CrossbowDemonic => Rectangle::new(40.0, 170.0, 10.0, 10.0),
        Sprite::Sling => Rectangle::new(50.0, 170.0, 10.0, 10.0),
        Sprite::Pipe => Rectangle::new(60.0, 170.0, 10.0, 10.0),
        Sprite::Pistol => Rectangle::new(70.0, 170.0, 10.0, 10.0),
        Sprite::Rifle => Rectangle::new(80.0, 170.0, 10.0, 10.0),
        Sprite::Slingshot => Rectangle::new(90.0, 170.0, 10.0, 10.0),
        Sprite::ArrowWood => Rectangle::new(0.0, 180.0, 10.0, 10.0),
        Sprite::ArrowStone => Rectangle::new(10.0, 180.0, 10.0, 10.0),
        Sprite::ArrowMetal => Rectangle::new(20.0, 180.0, 10.0, 10.0),
        Sprite::ArrowDemonic => Rectangle::new(30.0, 180.0, 10.0, 10.0),
        Sprite::ArrowObsidian => Rectangle::new(40.0, 180.0, 10.0, 10.0),
        Sprite::ArrowExplosive => Rectangle::new(50.0, 180.0, 10.0, 10.0),
        Sprite::ArrowBone => Rectangle::new(60.0, 180.0, 10.0, 10.0),
        Sprite::BoomgranateFruit => Rectangle::new(70.0, 180.0, 10.0, 10.0),
        Sprite::Rock => Rectangle::new(0.0, 190.0, 10.0, 10.0),
        Sprite::SharpRock => Rectangle::new(10.0, 190.0, 10.0, 10.0),
        Sprite::Pebble => Rectangle::new(20.0, 190.0, 10.0, 10.0),
        Sprite::MetalChunk => Rectangle::new(30.0, 190.0, 10.0, 10.0),
        Sprite::SharpMetalChunk => Rectangle::new(40.0, 190.0, 10.0, 10.0),
        Sprite::MetalShot => Rectangle::new(50.0, 190.0, 10.0, 10.0),
        Sprite::DemonicChunk => Rectangle::new(60.0, 190.0, 10.0, 10.0),
        Sprite::SharpDemonicChunk => Rectangle::new(70.0, 190.0, 10.0, 10.0),
        Sprite::DemonicShot => Rectangle::new(80.0, 190.0, 10.0, 10.0),
        Sprite::ObsidianChunk => Rectangle::new(90.0, 190.0, 10.0, 10.0),
        Sprite::Corpse => Rectangle::new(0.0, 200.0, 10.0, 10.0),
        Sprite::Book => Rectangle::new(10.0, 200.0, 10.0, 10.0),
        Sprite::WoodenSplinter => Rectangle::new(20.0, 200.0, 10.0, 10.0),
        Sprite::FleshChunk => Rectangle::new(30.0, 200.0, 10.0, 10.0),
        Sprite::Bone => Rectangle::new(40.0, 200.0, 10.0, 10.0),
        Sprite::Lazuli => Rectangle::new(50.0, 200.0, 10.0, 10.0),
        Sprite::ShovelWood => Rectangle::new(0.0, 210.0, 10.0, 10.0),
        Sprite::ShovelStone => Rectangle::new(10.0, 210.0, 10.0, 10.0),
        Sprite::ShovelMetal => Rectangle::new(20.0, 210.0, 10.0, 10.0),
        Sprite::ShovelDemonic => Rectangle::new(30.0, 210.0, 10.0, 10.0),
    }
}

const TILE_SIZE: i32 = 10;

#[derive(Debug)]
pub struct Tileset {
    pub tile_size: i32,
    pub texture: Texture,
}

impl Tileset {
    pub fn load(ctx: &mut Context) -> tetra::Result<Self> {
        Ok(Self {
            tile_size: TILE_SIZE, // TODO: support custom tilesets
            texture: Texture::from_encoded(ctx, include_bytes!("../../assets/img/tileset.png"))?,
        })
    }

    pub fn get_size(sprite: Sprite) -> Vec2 {
        let r = region(sprite);
        Vec2::new(r.width, r.height)
    }

    pub fn draw_sprite<P: Into<DrawParams>>(&self, ctx: &mut Context, sprite: Sprite, params: P) {
        self.texture.draw_region(ctx, region(sprite), params);
    }
}
